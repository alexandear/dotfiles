# https://blog.gitbutler.com/how-git-core-devs-configure-git/

[user]
	name = Oleksandr Redko
	email = oleksandr.red+github@gmail.com
[alias]
	# https://gist.github.com/schacon/e9e743dee2e92db9a464619b99e94eff
	bb = !~/.config/git/better-git-branch.sh
	br = branch -v
	ci = commit
	co = checkout
	crc = codereview change
	crm = codereview mail
	commend = commit --amend
	# Remove tracking branches no longer on remote. See https://stackoverflow.com/a/33548037
	dm="!git fetch --prune --all && for branch in $(git for-each-ref --format '%(refname) %(upstream:track)' refs/heads | awk '$2 == \"[gone]\" {sub(\"refs/heads/\", \"\", $1); print $1}'); do git branch -D $branch; done"
	df = diff
	ds = diff --staged
	ft = fetch --prune --all
	# Show files ignored by git:
	ign = ls-files -o -i --exclude-standard
	ignore = update-index --skip-worktree
	ignored = !git ls-files -v | grep \"^S\"
	lg = log --graph --decorate --pretty=oneline --abbrev-commit
	lola = log --graph --decorate --pretty=oneline --abbrev-commit --all --date=local
	ls = ls-files
	please = push --force-with-lease
	pushmr = push -u origin HEAD -o merge_request.create -o merge_request.target=master -o merge_request.remove_source_branch
	pushmra = push -u origin HEAD -o merge_request.create -o merge_request.target=master -o merge_request.merge_when_pipeline_succeeds -o merge_request.remove_source_branch
	reshard = reset --hard
	ri = rebase --interactive
	# Replace HTTPS remotes with SSH ones for all remotes in the repo
	rssh = "!f(){ for r in $(git remote); do url=$(git remote get-url $r); case $url in https://github.com/*) repo=${url#https://github.com/}; repo=${repo%.git}; new=git@github.com:${repo}.git; git remote set-url $r $new; git remote set-url --push $r $new; ;; git@github.com:*) ;; *) ;; esac; done; }; f"
	# Show the full hash of the last commit
	sha = rev-parse HEAD
	st = status -s
	sw = switch
	# Switch to default branch: `dev`, `main` or `master`
	swdef = "!f() { (git rev-parse --verify --quiet dev > /dev/null && git switch dev) || (git rev-parse --verify --quiet main > /dev/null && git switch main) || (git rev-parse --verify --quiet master > /dev/null && git switch master); unset -f f; }; f"
	unignore = update-index --no-skip-worktree
	unstage = reset HEAD
	zip = "archive HEAD -o"

[color]
	ui = true
[color "status"]
	changed = blue normal
	untracked = red normal
	added = magenta normal
	updated = green normal
	branch = yellow normal bold
	header = white normal bold
[difftool]
	prompt = false
# brew install diff-so-fancy
[diff-so-fancy]
	stripLeadingSymbols = true
[core]
	excludesFile = ~/.gitignore
	pager = diff-so-fancy | less --tabs=4 -RFX
	fsmonitor = true
	untrackedCache = true
[merge]
	keepBackup = false
	conflictstyle = zdiff3
[color "diff-highlight"]
	oldNormal = red bold
	oldHighlight = red bold 52
	newNormal = green bold
	newHighlight = green bold 22
[color "diff"]
	meta = 11
	frag = magenta bold
	commit = yellow bold
	old = red bold
	new = green bold
	whitespace = red reverse
[init]
	defaultBranch = main
[push]
	default = simple
	autoSetupRemote = true
	followTags = true
[pull]
	rebase = true
[fetch]
	prune = true
	pruneTags = false
	all = true
[includeIf "gitdir:~/src/github.com/"]
	path = ~/.gitconfig-github
[includeIf "gitdir:~/src/github.com/alexandear/**/.git"]
	path = ~/.gitconfig-alexandear
[includeIf "gitdir:~/src/gitlab.com/"]
	path = ~/.gitconfig-gitlab
[http]
	cookiefile = ~/.gitcookies
[help]
	autocorrect = prompt
[commit]
	verbose = true
[rerere]
	enabled = true
	autoupdate = true
[rebase]
	autoSquash = true
	autoStash = true
	updateRefs = true
[column]
	ui = auto
[branch]
	sort = -committerdate
[tag]
	sort = version:refname
[maintenance]
	repo = ~/src/github.com/golangci/golangci-lint
[credential "https://github.com"]
	helper = !/opt/homebrew/bin/gh auth git-credential
[credential "https://gist.github.com"]
	helper = !/opt/homebrew/bin/gh auth git-credential
